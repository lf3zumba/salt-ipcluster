{% set username = pillar.get('ipcluster.username', 'ipuser') %}
{% set home = pillar.get('ipcluster.userhome', '/home/ipuser') %}
{% set host_cpus = salt['ps.num_cpus']() %}

[program:ipengine]
command=ipengine
user={{ username }}
numprocs={{ host_cpus }}
process_name=ipengine-%(process_num)s
directory={{ pillar.get('ipcluster.engine.directory', home) }}
environment=HOME='{{ home }}',USER={{ username }}
